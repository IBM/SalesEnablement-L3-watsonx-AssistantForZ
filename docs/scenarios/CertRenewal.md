# Scenario: Certificate renewal 
## Scenario overview

!!! Quote "Speaker's script"

    Now, change your role to that of a security administrator. You have just been informed that one of your SSL certificates signed by a Certificate Authority is expiring soon. Secure Sockets Layer (SSL) certificates, sometimes called digital certificates, are used to establish an encrypted connection between communicating parties over a network. Certificate management is crucial for maintaining the security of our z/OS environment, but it has been a while since you have performed this action. You recall there are many steps required on z/OS and various RACF commands that need to be run to renew the certificate. Rather than going to your senior security administrator for assistance, you leverage the virtual assistant powered by watsonx to help automate the certificate renewal process. By automating these processes with Ansible, you ensure the certificates are always up to date and reduce the risk of expired certificates disrupting your services.

!!! Warning "Responses from the virtual assistant are likely to change"

    Responses generated by {{offering.name}} are likely to change over time. The responses you see when you run the queries may differ from the screen images captured in the {{guide.name}}. Using the exact queries specified will help assure a successful demonstration.
    
## Prerequisite steps
To run this scenario, a certificate must first be created. 

??? Tip "Copy and paste the prompt"

    Use the copy icon (![](_attachments/copyIcon.png)) to copy prompts from the demonstration guide and then paste the prompt into the Assistant using ++ctrl+v++ or right click and select ```Paste```.

Using the virtual assistant:

1. Create a certificate.
    
    <!--- begin-tab-group --->
    === "Prompt"

        ```
        create cert
        ```

    === "Sample output"

        ![](_attachments/cert-Setup001a.png)
    <!--- end-tab-group --->

2. Complete the form for the **z/OS Certs - Create Cert** skill and click **Apply**.
    
    <!--- begin-tab-group --->
    === "Input values"

        - **Certificate Label**: <*Enter a unique label of your choice, for example "yourNameCert". Record the label as it is needed later.*>
        - **CERT TYPE**: ```SITE```
        - **Expiration date**: <*Enter an expiration date within the next 30 days.*>
        - **Common name**: <*Enter a unique label of your choice, for example "company.com". Record the name as it is needed later. **Do NOT use test.com***>
        - **SIGN WITH**: ```CERTAUTH```
        - **SIGN LABEL**: ```TESTCA```   
    === "Sample input"

        ![](_attachments/cert-Setup001b.png)
    === "Sample output"
    
        ![](_attachments/cert-Setup001c.png)
    <!--- end-tab-group --->

The new certificate is created (despite the last message status of *pending*).

## Prompts and sample outputs

1. Ask the assistant how to check on an expiring certificate.

    <!--- begin-tab-group --->
    === "Prompt"

        ```
        I have a SSL certificate on z/OS expiring soon. How do I check when my certificate is going to expire?
        ```

    === "Sample output"
        ![](_attachments/cert-001a.png)
    <!--- end-tab-group --->

2. Click **Yes** to retrieve the certificate details.
3. Complete the form with the certificate label and type (use the same values as specified in the prerequisite steps) and click **Apply** twice.
    
    <!--- begin-tab-group --->
    === "Input values"
   
        - **CERT LABEL**: <*Enter the unique label of the certificate created in the setup steps.*>
        - **CERT TYPE**: ```SITE```
    === "Sample input"

        ![](_attachments/cert-001b.png)
    === "Sample output"
    
        ![](_attachments/cert-001c.png)
    <!--- end-tab-group --->

4. Ask the assistant how to renew a certificate.

    <!--- begin-tab-group --->
    === "Prompt"

        ```
        What are the steps to renew a certificate on z/OS?
        ```

    === "Sample output"
        ![](_attachments/cert-002a.png)
    <!--- end-tab-group --->

5. Click **Yes** to run the certificate renewal skill.
6. Complete the form to renew the certificate and click **Apply**.

    <!--- begin-tab-group --->
    === "Input values"

        - **CERT LABEL**: <*Enter the unique label of the certificate created in the setup steps.*>           
        - **CERT TYPE**: ```SITE```
        - **SIGN WITH**: ```CERTAUTH```
        - **SIGN LABEL**: ```TESTCA```
        - **extra_vars.new_expiry_date_survey**: <*Enter an expiration date on year from today.*>

    === "Sample input"
    
        ![](_attachments/cert-002b.png)
    === "Sample output"

        No output is returned.
    <!--- end-tab-group --->

7. Retrieve the certificate and verify the date was changed.
    
    <!--- begin-tab-group --->
    === "Prompt"

        ```
        Get my certificate details.
        ```

    === "Sample output"
        ![](_attachments/cert-003a.png)
    <!--- end-tab-group --->

8. Complete the form with the certificate label and type (use the same values as specified in the prerequisite steps) and click **Apply** twice.
    
    <!--- begin-tab-group --->
    === "Input values"
   
        - **CERT LABEL**: <*Enter the unique label of the certificate created in the setup steps.*>
        - **CERT TYPE**: ```SITE```
    === "Sample input"

        ![](_attachments/cert-003b.png)
    === "Sample output"
    
        ![](_attachments/cert-003c.png)
    <!--- end-tab-group --->

## Cleanup steps
Following the demo, cleanup the system by deleting the original certificate created.

Using the virtual assistant:

1. Delete the certificate.
    
    <!--- begin-tab-group --->
    === "Prompt"

        ```
        delete cert
        ```

    === "Sample output"

        ![](_attachments/cert-Delete001a.png)
    <!--- end-tab-group --->

2. Complete the form and click **Apply**.
    
    <!--- begin-tab-group --->
    === "Input values"

        - **CERT LABEL**: <*Enter the original certificate label that you created.*>
        - **CERT TYPE**: ```SITE```
    === "Sample input"

        ![](_attachments/cert-Delete001b.png)
    === "Sample output"
    
        ![](_attachments/cert-Delete001c.png)
    <!--- end-tab-group --->

